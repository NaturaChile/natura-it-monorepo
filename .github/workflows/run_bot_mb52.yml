name: Ejecutar Bot MB52 Manual

on:
  workflow_dispatch:

jobs:
  run_mb52:
    runs-on: [self-hosted, rpa-ui, Windows]
    environment: 10.156.16.48_WINDOWS
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Ejecutar bot_mb52.py
        shell: powershell
        env:
          PYTHON_EXE: ${{ vars.WIN_PYTHON_EXE }}
        run: |
          $script = "rpa_desktop_win/test_mb52/bot_mb52.py"
          $python = "$env:PYTHON_EXE"
          Write-Host "[INFO] Ejecutando $script con $python"
          if (!(Test-Path $script)) {
            Write-Error "[ERROR] Script no encontrado: $script"
            exit 1
          }
          & $python $script
